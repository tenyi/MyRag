# 中文 GraphRAG 系統配置範例
# 複製此檔案為 settings.yaml 並修改相關設定

# 模型配置
models:
  # 預設 LLM 模型
  default_chat_model:
    api_key: ${GRAPHRAG_API_KEY}
    type: openai_chat
    model: gpt-5-mini
    model_supports_json: true
    max_tokens: 2000
    temperature: 0.0
    timeout: 60
    max_retries: 3
  
  # 預設 Embedding 模型
  openai_embedding_model:
    api_key: ${GRAPHRAG_API_KEY}
    type: openai_embedding
    model: text-embedding-3-small
    batch_size: 32
    normalize_embeddings: true
  
  # 中文優化 Embedding 模型（BGE-M3）
  chinese_embedding_model:
    type: bge_m3
    model: BAAI/bge-m3
    device: auto  # auto, cpu, cuda, mps
    batch_size: 32
    max_length: 512
    normalize_embeddings: true
    cache_enabled: true
  
  # Ollama Chat 模型（推薦本地部署）
  ollama_chat_model:
    type: ollama
    model: gemma3
    api_base: http://localhost:11434
    max_tokens: 2000
    temperature: 0.0
    timeout: 60
    max_retries: 3
  
  # Ollama Embedding 模型
  ollama_embedding_model:
    type: ollama
    model: bge-m3
    api_base: http://localhost:11434
    batch_size: 32
    max_length: 512
    normalize_embeddings: true
    cache_enabled: true
  
  # Azure OpenAI 範例配置（可選）
  azure_chat_model:
    type: azure_openai_chat
    model: gpt-5-mini
    api_base: https://your-instance.openai.azure.com
    api_version: 2024-02-15-preview
    deployment_name: gpt-4-deployment
    api_key: ${AZURE_OPENAI_API_KEY:}

# 向量資料庫配置
vector_store:
  type: lancedb
  uri: ./data/lancedb
  container_name: default
  overwrite: false
  table_name: vectors
  metric: cosine
  index_cache_size: 256

# 中文文本處理配置
chinese_processing:
  tokenizer: jieba
  enable_traditional_chinese: true
  custom_dict_path: null
  stop_words_path: null
  enable_pos_tagging: false
  enable_ner: false

# 輸入配置
input:
  file_type: text
  supported_formats: [txt, pdf, docx, md]
  base_dir: input
  file_encoding: utf-8
  file_pattern: ".*\\.(txt|pdf|docx|md)$"
  recursive: true

# 文本分塊配置
chunks:
  size: 1000
  overlap: 200
  group_by_columns: [id]
  strategy: token

# 索引配置
indexing:
  enable_entity_extraction: true
  enable_relationship_extraction: true
  enable_community_detection: true
  enable_community_reports: true
  enable_llm_reports: false
  entity_types: [organization, person, geo, event]
  max_gleanings: 1
  max_cluster_size: 10
  min_community_size: 3
  max_community_size: 50
  enable_hierarchical_communities: true
  community_resolution: 1.0
  enable_graph_embedding: false

# 查詢配置
query:
  enable_global_search: false
  enable_local_search: true
  enable_drift_search: false
  max_tokens: 2000
  temperature: 0.0
  top_k: 10
  similarity_threshold: 0.7

# 儲存配置
storage:
  type: file
  base_dir: output
  cache_dir: cache
  logs_dir: logs

# 並行處理配置
parallelization:
  num_threads: 4
  stagger: 0.3
  async_mode: threaded
  batch_size: 10

# 模型選擇策略配置
model_selection:
  default_llm: ollama_chat_model
  default_embedding: ollama_embedding_model
  cost_optimization: true
  quality_threshold: 0.8
  fallback_models:
    ollama_chat_model: default_chat_model
    ollama_embedding_model: chinese_embedding_model
    chinese_embedding_model: openai_embedding_model
    default_chat_model: azure_chat_model

# 跳過的工作流程
skip_workflows: []